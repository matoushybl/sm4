\chapter{Results}
\label{ch:results}
This chapter discusses the implemented functionality, features and the final state of the project in general.
Apart from the final project state, two demonstrations are showcased - one of them being a small mobile robot for indoor mapping, and the second one being a stepper motor driven linear rail useful for example for camera movement.

\section{Final Project State}
\label{sec:final_project_state}

% TODO add pictures of the controllers

\subsubsection{Features}

\subsubsection{CAN API}
\subsubsection{I\textsuperscript{2}C API}
\subsubsection{USB API}

\subsection{Takeaways for Future Revisions}
\label{subsec:final_takeaways}
In this section, we describe what changes we'd made in a possible future revisions.
The changes are:
\begin{itemize}
    \item Use XT-30 connector for motor power.
    \item Use different connectors for motors.
    \item Use standardized 10 pin JTAG connector for SWD (Serial Wire Debug).
    \item Use eFuse for electronics protection.
    \item Add more status LEDs.
    \item Improve encoder connector placement, select appropriate connectors.
    \item Remove compatibility resistors around the CAN transceiver.
    \item Attempt to utilize async Rust for easier development.
    \item Rework the schematic to include more information, such as maximal capacitor voltages, add reasoning about component values.
    \item Improve current sensing circuitry to support motors with different phase currents and use sensing resistors with proper power rating. The current should be easily configurable.
\end{itemize}

\section{Demonstration \#1 - Linear Rail Actuator for Camera Movement}
\label{sec:dem2}
The second demonstration for the SM4 motor controller is controlling a single axis linear rail actuator.
This actuator was provided by the thesis supervisor and is equipped with a NEMA17 stepper motor that drives a belt with attached table.
Originally, this rail was meant to be used for camera movement when recording a musician.

This demonstration is again controlled using a Raspberry Pi 4B, but this time the SM4 motor controller is controlled using I\textsuperscript{2}C.
This showcase aims to demonstrate the controller's ability to control in position mode and therefore to position the table on the rail according to the commands of the higher-level system.
In the future, this demonstration will be equipped with a second axis allowing for tilting the mounted camera.
The finished demonstrator can be seen in the Figure~\ref{fig:rail_demonstrator}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.7\textwidth]{obrazky/rail}
    \caption{The MAP-bot robot - the first demonstration of the SM4 stepper motor controller.}
    \label{fig:rail_demonstrator}
\end{figure}

\section{Demonstration \#2 - Small Mobile Robot for Indoor Mapping}
\label{sec:dem1}
\epigraph{
    Any exploration program which "just happens" to include a new launch vehicle is, de facto, a launch vehicle program. \\ \\
    (alternate formulation) The three keys to keeping a new human space program affordable and on schedule: \\
1)  No new launch vehicles. \\
2)  No new launch vehicles. \\
3)  Whatever you do, don't develop any new launch vehicles.}{Akin's Laws of Spacecraft Design\cite{akin_akins_nodate}}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\textwidth]{obrazky/mapbot_block_diag}
    \caption{Designing the MCU connections using STM32CubeMX.}
    \label{fig:mapbot_block}
\end{figure}

The first demonstration, where we showcase the SM4 stepper motor controller, is a small differentially driven robot aimed for indoor mapping and self-localization.
The chassis is differential with one motor on two sides of the robot, which showcases the driver's ability to control both of the motor and calculate odometry.
Apart from the driver itself, the robot features a Raspberry Pi 4B SBC, 4 cell Li-Ion battery, step-down converter and a simple planar LIDAR for the mapping task.
It is projected, that the robot will be utilized for algorithm demonstration as part of the MPC-MAP - Advanced Mapping and Self-Localization for Robotics course.
The finalized robot can be seen in the Figure~\ref{fig:map_bot}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.7\textwidth]{obrazky/map_bot}
    \caption{The MAP-bot robot - the first demonstration of the SM4 stepper motor controller.}
    \label{fig:map_bot}
\end{figure}

As part of the demonstration, the Raspberry Pi SBC controls the robot to move forward, backward and rotate via CANOpen control of the SM4 stepper motor controller.
